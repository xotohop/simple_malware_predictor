import pandas as pd
import xgboost
import pickle

train = pd.read_csv('tsv_pp/train.tsv', delimiter='\t')
X_train = train.drop(['is_virus', 'libs'], axis=1)
y_train = train['is_virus']

param_dist = {'n_estimators':80, 'max_depth':16, 'learning_rate':1, 'verbosity':0,\
                'booster':'gbtree', 'tree_method':'hist', 'use_label_encoder':False}
classifier = xgboost.XGBClassifier(**param_dist)
model = classifier.fit(X_train, y_train, verbose=False)

pkl_filename = 'XGBoost_model.pkl'
with open('models/' + pkl_filename, 'wb') as file:
    pickle.dump(model, file)
