import pandas as pd
from sklearn.ensemble import RandomForestClassifier
import pickle

train = pd.read_csv('tsv_pp/train.tsv', delimiter='\t')
X_train = train.drop(['is_virus', 'libs'], axis=1)
y_train = train['is_virus']

classifier = RandomForestClassifier(n_estimators=34)
model = classifier.fit(X_train, y_train)

pkl_filename = "RandomForest_model.pkl"
with open(pkl_filename, 'wb') as file:
    pickle.dump(model, file)
