import pandas as pd
from sklearn.metrics import\
        confusion_matrix, accuracy_score,\
        precision_score, recall_score, f1_score
import pickle

val = pd.read_csv('tsv_pp/val.tsv', delimiter='\t')
X_val = val.drop(['is_virus', 'libs'], axis=1)
y_val = val['is_virus']

pkl_filename = 'XGBoost_model.pkl'
with open('models/' + pkl_filename, 'rb') as file:
    model = pickle.load(file)

prediction = model.predict(X_val)

results = confusion_matrix(y_val,prediction)
accuracy = accuracy_score(y_val, prediction)
precision = precision_score(y_val, prediction)
recall = recall_score(y_val, prediction)
f1 = f1_score(y_val, prediction)

with open('output/validation.txt', 'w') as file:
    file.write('True positive: {}\n'.format(results[0][0]))
    file.write('False positive: {}\n'.format(results[1][0]))
    file.write('False negative: {}\n'.format(results[0][1]))
    file.write('True negative: {}\n'.format(results[1][1]))
    file.write('Accuracy: {:.5f}\n'.format(accuracy))
    file.write('Precision: {:.5f}\n'.format(precision))
    file.write('Recall: {:.5f}\n'.format(recall))
    file.write('F1: {:.5f}'.format(f1))
